http 请求

axios 框架在浏览器和 Node 中，都可以使用。

在浏览器中，基于 XHR 进行了封装。

在 Node 中，没有 XHR 技术，是基于 http 模块，进行的封装。



使用 http 发送 get 请求；

回调函数中传入的是 response 对象，本质上是可读流。



http 模块调用 request 犯法，发送请求。

返回 request 对象，本质上是可写流。



安装 axios，在 Node 环境中使用。

---

文件上传

真是开发中，后端（不管是 Node 还是 Java）手动处理文件上传非常复杂，一般借助于插件完成。

为了解文件上传的完整过程，进行演示。



在客户端，如浏览器，一般都是通过表单的形式，进行上传。

input type file



在 postman 中，模拟文件上传。

使用 POST 方法，

填写 url，

文件放在 Body 请求体中。选择 form-data，类型选择 file。



上床的图片比较下，可一次性读取到，如果上传的图片比较大，会分成几次读取。



文件上传完整流程，但是是错误的示范：

创建一个可写流，将读取到的数据，保存下来。

不能把读取到的数据，全部吸入保存下来，需要去除一些多余的数据。

---

去除多余数据的操作，有点繁琐。

读取图片这样的二进制数据时，不要设置编码为 utf8，而是 binary；

之后，会使用 Ascll 编码，对每个字节进行转换。

如果编码出来的是文本，就能看到，如果是二进制文件，是看不懂的。

发现控制台中，要显示数据过多，有些被隐藏了。



在 VSCode 中，为 Node 程序使用 Debug。

在打印 data 的那行代码上，打上断点。

可看到传输到服务器的完整数据，里面有请求中的一些多余信息。



读取到所有的数据后，进行截取。

使用正则表达式匹配“/r/n"，使用 /^\s\s/

获取 boundary 并替换掉它



具体步骤见代码。

模拟给客户端返回文件上传的进度。



在浏览器中上传文件，进行测试。

现在一般不用原生表单上传了，那是早期后端渲染时，JSP 会采用的。

注意：在用 liverServer 本地测试时，上传图片后可能会刷新，这是因为写入的图片，可能保存在了开启 Web 服务的目录下。

---

Web 服务器框架是什么？

Express 框架核心是中间件。

---

Express 安装

两种方式。

---

Express 的基本使用

res, req 经过 express 的封装，并不是原生的 response、request 对象。

---

中间件是什么？

为什么 express 矿建中，可以单独处理 method 和 url 呢？其实是使用了中间件的原因。

调用 get 方法，传入的回调函数，本质上就是一个中间件。

创建一个中间件，嗲用 next 方法，执行可匹配到的下一个中间件。

---

如何编写并注册中间件

使用 use 注册一个最普通简单的中间件。